@model SGP_Freelancing.Utilities.PagedResult<SGP_Freelancing.Models.DTOs.ProjectDto>
@{
    ViewData["Title"] = "Browse Projects";
}

<!-- Browse Header -->
<div class="bg-gradient-to-br from-indigo-600 to-purple-700 py-16 mb-8 relative overflow-hidden">
    <div class="absolute inset-0 bg-white/10 rounded-full w-96 h-96 -top-48 -right-48 blur-3xl"></div>
    <div class="max-w-4xl mx-auto px-4 relative z-10">
        <h1 class="text-5xl font-bold text-white text-center mb-4">Find Your Next Project</h1>
        <p class="text-center text-white/90 text-lg mb-8">Browse thousands of projects and start earning today</p>
        
        <form asp-action="Index" method="get" class="max-w-2xl mx-auto">
            <div class="bg-white dark:bg-slate-800 rounded-2xl p-2 shadow-2xl dark:shadow-slate-900/50 flex transition-colors duration-300">
                <i class="fas fa-search text-slate-400 dark:text-slate-500 self-center ml-4 transition-colors duration-300"></i>
                <input type="text" name="searchTerm" placeholder="Search for projects..." value="@ViewBag.SearchTerm" class="flex-1 px-4 py-4 text-lg border-none outline-none rounded-xl bg-transparent text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-slate-500 transition-colors duration-300">
                <button type="submit" class="inline-flex items-center justify-center px-8 py-4 text-lg font-semibold text-white bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl shadow-md hover:shadow-lg hover:-translate-y-0.5 transition-all">
                    <i class="fas fa-search mr-2"></i>Search
                </button>
            </div>
        </form>
    </div>
</div>

<div class="max-w-7xl mx-auto px-4 bg-slate-50 dark:bg-[#0B1120] transition-colors duration-300">
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
        <!-- Filter Sidebar -->
        <div class="lg:col-span-1">
            <div class="bg-white dark:bg-slate-800 rounded-xl border border-slate-100 dark:border-slate-700 shadow-md p-6 sticky top-24 transition-colors duration-300">
                <div class="flex items-center mb-6">
                    <i class="fas fa-filter text-indigo-600 dark:text-indigo-400 mr-2 transition-colors duration-300"></i>
                    <h3 class="text-xl font-bold text-slate-900 dark:text-white transition-colors duration-300">Filters</h3>
                </div>

                <form asp-action="Index" method="get">
                    <input type="hidden" name="searchTerm" value="@ViewBag.SearchTerm">
                    
                    <!-- Category Filter -->
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3 transition-colors duration-300">Category</label>
                        <div class="space-y-2">
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="categoryId" value="" class="w-4 h-4 text-indigo-600 mr-3" checked>
                                <span class="text-sm text-slate-600 dark:text-slate-400 transition-colors duration-300">All Categories</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="categoryId" value="1" class="w-4 h-4 text-indigo-600 mr-3">
                                <span class="text-sm text-slate-600 dark:text-slate-400 transition-colors duration-300">Web Development</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="categoryId" value="2" class="w-4 h-4 text-indigo-600 mr-3">
                                <span class="text-sm text-slate-600 dark:text-slate-400 transition-colors duration-300">Graphic Design</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="categoryId" value="3" class="w-4 h-4 text-indigo-600 mr-3">
                                <span class="text-sm text-slate-600 dark:text-slate-400 transition-colors duration-300">Content Writing</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="categoryId" value="4" class="w-4 h-4 text-indigo-600 mr-3">
                                <span class="text-sm text-slate-600 dark:text-slate-400 transition-colors duration-300">Digital Marketing</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="categoryId" value="5" class="w-4 h-4 text-indigo-600 mr-3">
                                <span class="text-sm text-slate-600 dark:text-slate-400 transition-colors duration-300">Video Editing</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="categoryId" value="6" class="w-4 h-4 text-indigo-600 mr-3">
                                <span class="text-sm text-slate-600 dark:text-slate-400 transition-colors duration-300">Mobile Apps</span>
                            </label>
                        </div>
                    </div>

                    <!-- Budget Range -->
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3 transition-colors duration-300">Budget Range</label>
                        <select name="budgetRange" class="w-full px-4 py-3 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-gray-900 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors duration-300">
                            <option value="">Any Budget</option>
                            <option value="0-500">$0 - $500</option>
                            <option value="500-1000">$500 - $1,000</option>
                            <option value="1000-2500">$1,000 - $2,500</option>
                            <option value="2500-5000">$2,500 - $5,000</option>
                            <option value="5000+">$5,000+</option>
                        </select>
                    </div>

                    <button type="submit" class="w-full inline-flex items-center justify-center px-6 py-3 font-semibold text-white bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl shadow-md hover:shadow-lg hover:-translate-y-0.5 transition-all">
                        Apply Filters
                    </button>
                </form>
            </div>
        </div>

        <!-- Projects Grid -->
        <div class="lg:col-span-3">
            @if (User.IsInRole("Client"))
            {
                <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mb-6 transition-colors duration-300">
                    <i class="fas fa-info-circle text-blue-600 dark:text-blue-400 mr-2 transition-colors duration-300"></i>
                    <span class="text-blue-800 dark:text-blue-300 transition-colors duration-300">Want to post a project? <a asp-action="Create" class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 font-semibold">Click here to get started</a></span>
                </div>
            }

            <div class="flex justify-between items-center mb-8">
                <div class="text-lg text-slate-600 dark:text-slate-400 transition-colors duration-300">
                    <span class="font-bold text-slate-900 dark:text-white transition-colors duration-300">@Model.TotalCount</span> projects found
                </div>
                <select class="px-4 py-2 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg font-semibold focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors duration-300">
                    <option>Sort by: Newest</option>
                    <option>Sort by: Budget (High to Low)</option>
                    <option>Sort by: Budget (Low to High)</option>
                    <option>Sort by: Most Bids</option>
                </select>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                @if (Model.Items.Any())
                {
                    @foreach (var project in Model.Items)
                    {
                        <div class="bg-white dark:bg-slate-800 rounded-xl shadow-md border-2 border-transparent dark:border-slate-700 p-6 transition-all hover:shadow-xl hover:-translate-y-2 hover:border-indigo-200 dark:hover:border-indigo-600 duration-300">
                            <span class="inline-block px-3 py-1 bg-gradient-to-r from-indigo-600 to-purple-600 text-white text-xs font-semibold rounded-full mb-4">@project.CategoryName</span>
                            <h4 class="text-xl font-bold text-slate-900 dark:text-white mb-3 line-clamp-2 transition-colors duration-300">@project.Title</h4>
                            <p class="text-slate-600 dark:text-slate-400 mb-4 line-clamp-3 transition-colors duration-300">
                                @(project.Description.Length > 150 ? project.Description.Substring(0, 150) + "..." : project.Description)
                            </p>
                            
                            @if (project.Skills.Any())
                            {
                                <div class="flex flex-wrap gap-2 mb-4">
                                    @foreach (var skill in project.Skills.Take(4))
                                    {
                                        <span class="px-3 py-1 bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 text-xs font-medium rounded-full transition-colors duration-300">@skill</span>
                                    }
                                    @if (project.Skills.Count() > 4)
                                    {
                                        <span class="px-3 py-1 bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 text-xs font-medium rounded-full transition-colors duration-300">+@(project.Skills.Count() - 4) more</span>
                                    }
                                </div>
                            }
                            
                            <div class="flex justify-between items-center pt-4 border-t border-slate-200 dark:border-slate-700 transition-colors duration-300">
                                <div>
                                    <div class="text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">$@project.Budget.ToString("N0")</div>
                                    <div class="flex space-x-4 text-sm text-slate-500 dark:text-slate-400 mt-1 transition-colors duration-300">
                                        <span><i class="fas fa-user mr-1"></i>@project.ClientName</span>
                                        <span><i class="fas fa-users mr-1"></i>@project.BidsCount bids</span>
                                    </div>
                                </div>
                            </div>
                            
                            <a asp-action="Details" asp-route-id="@project.Id" class="block w-full mt-4 text-center px-6 py-3 font-semibold text-white bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl shadow-md hover:shadow-lg hover:-translate-y-0.5 transition-all">
                                View Details <i class="fas fa-arrow-right ml-2"></i>
                            </a>
                        </div>
                    }
                }
                else
                {
                    <div class="col-span-2 text-center py-20">
                        <div class="text-6xl text-slate-300 mb-6">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-slate-900 mb-3">No Projects Found</h3>
                        <p class="text-slate-600 mb-6">
                            We couldn't find any projects matching your criteria.<br>
                            Try adjusting your filters or search terms.
                        </p>
                        @if (User.IsInRole("Client"))
                        {
                            <a asp-action="Create" class="inline-flex items-center justify-center px-6 py-3 font-semibold text-white bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl shadow-md hover:shadow-lg hover:-translate-y-0.5 transition-all">
                                Post the First Project
                            </a>
                        }
                    </div>
                }
            </div>

            <!-- Pagination -->
            @if (Model.TotalPages > 1)
            {
                <div class="flex justify-center space-x-2 mt-10">
                    <a class="px-4 py-2 border-2 border-slate-300 rounded-lg text-slate-600 font-semibold hover:border-indigo-600 hover:text-indigo-600 transition-all @(Model.HasPrevious ? "" : "opacity-50 cursor-not-allowed")" 
                       asp-action="Index" asp-route-pageNumber="@(Model.PageNumber - 1)" asp-route-categoryId="@ViewBag.CategoryId" asp-route-searchTerm="@ViewBag.SearchTerm">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                    
                    @for (int i = 1; i <= Model.TotalPages; i++)
                    {
                        <a class="px-4 py-2 border-2 rounded-lg font-semibold transition-all @(i == Model.PageNumber ? "bg-gradient-to-r from-indigo-600 to-purple-600 text-white border-transparent" : "border-slate-300 text-slate-600 hover:border-indigo-600 hover:text-indigo-600")" 
                           asp-action="Index" asp-route-pageNumber="@i" asp-route-categoryId="@ViewBag.CategoryId" asp-route-searchTerm="@ViewBag.SearchTerm">@i</a>
                    }
                    
                    <a class="px-4 py-2 border-2 border-slate-300 rounded-lg text-slate-600 font-semibold hover:border-indigo-600 hover:text-indigo-600 transition-all @(Model.HasNext ? "" : "opacity-50 cursor-not-allowed")" 
                       asp-action="Index" asp-route-pageNumber="@(Model.PageNumber + 1)" asp-route-categoryId="@ViewBag.CategoryId" asp-route-searchTerm="@ViewBag.SearchTerm">
                        <i class="fas fa-chevron-right"></i>
                    </a>
                </div>
            }
        </div>
    </div>
</div>